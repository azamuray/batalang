# Changelog

Все значимые изменения в проекте English Battle будут документироваться в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и проект следует [Semantic Versioning](https://semver.org/lang/ru/).

## [Unreleased]

### Added
- Файл CHANGELOG.md для документирования изменений

## [1.2.0] - 2025-08-16

### Added
- **SSL сертификация Let's Encrypt** с автоматической настройкой
  - Автоматическое получение SSL сертификатов при первом деплое
  - Автоматическое обновление сертификатов каждые 90 дней
  - HTTP → HTTPS редирект для безопасности
  - Веб-валидация через nginx для Let's Encrypt

- **Автоматизация деплоя**
  - Скрипт `deploy.sh` для полного автоматического деплоя
  - Контейнер `init` для автоматической инициализации SSL
  - Автоматическое создание необходимых директорий
  - Проверка готовности сервисов перед настройкой SSL

- **Улучшенная конфигурация nginx**
  - SSL конфигурация с современными протоколами (TLS 1.2/1.3)
  - Оптимизированные SSL шифры для безопасности
  - Правильные заголовки прокси для работы с SSL
  - Автоматическая перезагрузка nginx при обновлении сертификатов

### Changed
- **Обновлен docker-compose.yml**
  - Добавлен сервис `certbot` для управления SSL
  - Добавлен сервис `init` для автоматической инициализации
  - Настроены volumes для хранения сертификатов
  - Добавлена сеть `app-network` для изоляции контейнеров

- **Обновлен nginx.conf**
  - Добавлена поддержка SSL на порту 443
  - Настроен редирект с HTTP на HTTPS
  - Добавлена поддержка Let's Encrypt веб-валидации
  - Улучшены заголовки прокси для корректной работы с SSL

- **Обновлен README.md**
  - Добавлена полная документация по деплою с SSL
  - Инструкции по автоматическому и ручному деплою
  - Описание архитектуры SSL и требований
  - Полезные команды для управления и отладки

### Security
- **SSL/TLS шифрование** для всех HTTP соединений
- **Автоматическое обновление** SSL сертификатов
- **Современные протоколы** TLS 1.2 и TLS 1.3
- **Безопасные шифры** для SSL соединений

## [1.1.0] - 2025-08-10

### Changed
- Количество вариантов ответов уменьшено с 10 до 6
  - Генерация опций вынесена в функцию `generate_translations` на сервере (`app.py`)
  - Гарантируется один правильный вариант и отсутствие дублей

## [1.0.4] - 2025-08-10

### Fixed
- **Минорный баг**: у игрока, ответившего неверно первым, счет соперника обновлялся не сразу
  - Клиент больше не игнорирует `answer_result`, когда `canAnswer=false`
  - Счет и статус раунда обновляются сразу у обоих клиентов

## [1.0.3] - 2025-08-10

### Fixed
- **Минорный баг**: у оппонента, который не отвечал, отображалось сообщение «Неверно…»
  - Добавлен флаг `you_answered` в событие `answer_result` на сервере (`app.py`)
  - Клиент при `you_answered=false` показывает нейтральное сообщение о завершении раунда
  - Исключено ложное «Неверно…» для игрока, который не делал выбор

## [1.0.2] - 2025-08-10

### Fixed
- **Важный баг**: Раунд зависал, если оба игрока отвечали неверно
  - Добавлены состояния раунда (`answered`, `round_over`)
  - Блокируются повторные ответы одного игрока в рамках раунда
  - Автоматический запуск нового раунда при двух неверных ответах
  - Реализация на сервере в `app.py`

## [1.0.1] - 2025-08-10

### Fixed
- **Критический баг**: Игра не завершалась при достижении 15 очков
  - Добавлена проверка достижения 15 очков в бэкенде (`app.py`)
  - Реализовано автоматическое завершение игры на сервере
  - Добавлено событие `game_over` для корректного завершения игры
  - Игра теперь удаляется из активных игр при достижении победного счета

### Changed
- Улучшена логика завершения игры в функции `handle_answer`
- Добавлено логирование для отладки игрового процесса
- Убрана дублирующая проверка счета на фронтенде

### Added
- Кнопка "Новая игра" после завершения игры
- Обработчик события `game_over` на фронтенде
- Улучшенная функция `resetGame` для корректного сброса состояния
- Логирование достижения 15 очков и завершения игры

## [1.0.0] - 2025-08-10

### Added
- Базовая функциональность игры English Battle
- Система авторизации пользователей
- Поиск соперника для игры
- Игровой процесс с выбором правильного перевода
- Подсчет очков в реальном времени
- WebSocket соединение для многопользовательской игры

---

## Типы изменений

- **Added** - новая функциональность
- **Changed** - изменения в существующей функциональности
- **Deprecated** - функциональность, которая будет удалена в будущем
- **Removed** - удаленная функциональность
- **Fixed** - исправления багов
- **Security** - исправления уязвимостей безопасности

## Рекомендации по ведению

1. **Добавляйте записи** для каждого значимого изменения
2. **Используйте четкие заголовки** для каждого типа изменения
3. **Включайте детали** о том, что именно изменилось
4. **Указывайте даты** для каждой версии
5. **Группируйте изменения** по типам (Added, Changed, Fixed, etc.)
6. **Добавляйте ссылки** на issues/PR если они есть

## Пример записи

```markdown
## [1.1.0] - 2024-12-20

### Added
- Новая функция чата между игроками
- Система достижений

### Fixed
- Исправлен баг с отображением счета
- Улучшена производительность при большом количестве игроков
```
